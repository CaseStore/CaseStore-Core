{#
# @license 3-clause BSD
# @link https://github.com/CaseStore/CaseStore-Core
#}

{% extends 'CaseStoreBundle::base.html.twig' %}

{% block main %}

    <ol class="breadcrumb">
        <li><a href="{{ path('case_store_project', { 'projectId':project.publicId }) }}">Project {{  project.title }}</a></li>
        <li class="active">Output</li>
    </ol>

    <h1>Output</h1>

    {%  for fieldDefinition in fieldDefinitions %}
        <div class="outputDataLabel">{{  fieldDefinition.title }}</div>
        {%  if fieldValues[fieldDefinition.publicId] is defined and fieldValues[fieldDefinition.publicId] %}
            {% if fieldDefinition.isTypeString %}
                <div>{{ fieldValues[fieldDefinition.publicId].value  }}</div>
            {% elseif fieldDefinition.isTypeText %}
                <div>{{ fieldValues[fieldDefinition.publicId].value  | nl2br }}</div>
            {%  endif %}
        {%  endif %}
        <div></div>
    {%  endfor %}

    {%  if documents %}
        <div class="outputDataLabel">Documents</div>
        <ul>
            {%  for document in documents %}
                <li>
                    <div>{{  document.title }}</div>
                    <div><a href="{{ path('case_store_output_document_download', { 'projectId':project.publicId, 'outputId':output.publicId,'documentId':document.publicId  }) }}">Download {{ document.originalFileName }}</a></div>
                </li>
            {%  endfor %}
        </ul>
    {%  endif %}

    {%  if caseStudies %}
        <div class="outputDataLabel">CaseStudies involved</div>
        <ul>
            {%  for caseStudy in caseStudies %}
                <li>
                    <div>
                        <a href="{{ path('case_store_case_study', { 'projectId':project.publicId,'caseStudyId':caseStudy.publicId }) }}">{{  caseStudy.titleOrPlaceHolder }}</a>
                    </div>
                    <div>
                        {{  caseStudy.description | nl2br }}
                    </div>
                </li>
            {%  endfor %}
        </ul>
    {%  endif %}

    <ul class="list-group">
        {%  if editAccessAllowed %}
            {%  for fieldDefinition in fieldDefinitions %}
                <li class="list-group-item"><a href="{{ path('case_store_output_edit_field', { 'projectId':project.publicId, 'outputId':output.publicId, 'fieldDefinitionId':fieldDefinition.publicId }) }}" class="btn btn-warning">Edit {{ fieldDefinition.title  }}</a></li>
            {%  endfor %}
            <li class="list-group-item"><a href="{{  path('case_store_output_new_document', { 'projectId':project.publicId, 'outputId':output.publicId }) }}" class="btn btn-warning">New Document</a></li>
        {%  endif %}
    </ul>

    <div class="pull-right">
        Output ID: {{  output.publicId }}
    </div>

{%  endblock %}
